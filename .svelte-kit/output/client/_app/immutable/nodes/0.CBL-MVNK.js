import"../chunks/Bzak7iHL.js";import{i as I}from"../chunks/DKTCnNbX.js";import{h as J,K as N,p as Q,o as R,f as A,y as U,z as E,A as g,c as P,d as V,B as a,D as n,E as s,C as z}from"../chunks/D6nPkcoS.js";import{i as W,s as X,a as d}from"../chunks/BDAMK1gS.js";import{s as $,p as Y}from"../chunks/DycXGPVy.js";import{g as Z}from"../chunks/CwdQBBZU.js";import{i as tt,a as j,s as k,b as et,c as at,t as st}from"../chunks/B5_lSiN-.js";function ot(h,l,u,v,p){var o;J&&N();var i=(o=l.$$slots)==null?void 0:o[u],f=!1;i===!0&&(i=l.children,f=!0),i===void 0||i(h,f?()=>v:v)}const it=!1,pt=Object.freeze(Object.defineProperty({__proto__:null,ssr:it},Symbol.toStringTag,{value:"Module"}));var rt=A('<div><div class="toast-content svelte-12qhfyh"><div class="toast-icon svelte-12qhfyh"> </div> <div class="toast-message svelte-12qhfyh"> </div></div></div>'),nt=A('<main class="app svelte-12qhfyh"><nav class="nav-bar svelte-12qhfyh"><div class="nav-content svelte-12qhfyh"><h1 class="nav-title svelte-12qhfyh">p2pandashchat!</h1> <div class="nav-links svelte-12qhfyh"><button>Groups</button> <button>Friends</button> <button class="nav-link btn-outline svelte-12qhfyh">Copy Friend Code</button></div></div></nav> <div class="main-content svelte-12qhfyh"><!></div></main> <!>',1);function yt(h,l){Q(l,!1);const u=()=>d(Y,"$page",o),v=()=>d(j,"$myFriendCode",o),p=()=>d(et,"$showToast",o),i=()=>d(at,"$isErrorToast",o),f=()=>d(st,"$toastMessage",o),[o,K]=X();R(async()=>{console.log("Loading public key");let t=10,e=null;for(;t>0;)try{const r=await tt("me");j.set(r),console.log("Friend code loaded:",r,"tries left:",t);break}catch(r){t--,e=r,await new Promise(c=>setTimeout(c,500))}t===0&&(console.error("Failed to load friend code:",e),k("Failed to initialize app",!0))});function q(t){Z(t)}function w(t){return u().url.pathname===t}async function O(){try{if(!v())throw new Error("Pubkey not set");await navigator.clipboard.writeText(v()),k("Public key copied to clipboard!")}catch(t){console.error("Failed to copy public key:",t),k("Failed to copy public key",!0)}}I();var T=nt(),y=U(T),m=a(y),F=a(m),C=n(a(F),2),_=a(C),b=n(_,2),S=n(b,2);s(C),s(F),s(m);var M=n(m,2),B=a(M);ot(B,l,"default",{}),s(M),s(y);var D=n(y,2);{var G=t=>{var e=rt(),r=a(e),c=a(r),L=a(c,!0);s(c);var x=n(c,2),H=a(x,!0);s(x),s(r),s(e),E(()=>{$(e,1,`toast ${i()?"error":""} ${p()?"toast-show":""}`,"svelte-12qhfyh"),z(L,i()?"✕":"✓"),z(H,f())}),P(t,e)};W(D,t=>{p()&&t(G)})}E((t,e)=>{$(_,1,`nav-link ${t??""}`,"svelte-12qhfyh"),$(b,1,`nav-link ${e??""}`,"svelte-12qhfyh")},[()=>w("/groups")?"active":"",()=>w("/friends")?"active":""]),g("click",_,()=>q("/groups")),g("click",b,()=>q("/friends")),g("click",S,O),P(h,T),V(),K()}export{yt as component,pt as universal};
