import"../chunks/Bzak7iHL.js";import{p as X,o as Y,f as _,y as E,A as i,c as b,d as Z,B as s,D as n,E as r,l,v as L,F as v,H as ee,I as ae,z as te,C as M}from"../chunks/D6nPkcoS.js";import{i as P,s as se,a as re}from"../chunks/BDAMK1gS.js";import{e as de,b as ie,s as z,a as B}from"../chunks/D73Bnykk.js";import{i as w,f as H,s as p}from"../chunks/B5_lSiN-.js";var ne=_('<div class="empty-state svelte-1ggmuka"><p>No friends yet. Add a friend using their FriendCode!</p></div>'),oe=_('<div class="friend-card svelte-1ggmuka"><div class="friend-info svelte-1ggmuka"><h3 class="friend-key svelte-1ggmuka"> </h3> <p class="friend-added svelte-1ggmuka"> </p></div> <button class="btn btn-small btn-outline svelte-1ggmuka">Remove</button></div>'),le=_('<div class="modal-overlay svelte-1ggmuka" role="button" tabindex="0"><div class="modal svelte-1ggmuka" role="dialog" tabindex="0"><h3 class="svelte-1ggmuka">Add Friend</h3> <p class="modal-description svelte-1ggmuka">Enter the FriendCode of the person you want to add as a friend.</p> <textarea placeholder="Paste the friend code here (long hex string)..." class="modal-textarea svelte-1ggmuka" rows="4"></textarea> <div class="modal-actions svelte-1ggmuka"><button class="btn btn-secondary svelte-1ggmuka">Cancel</button> <button class="btn btn-primary svelte-1ggmuka">Add Friend</button></div></div></div>'),ve=_('<div class="friends-view svelte-1ggmuka"><header class="friends-header svelte-1ggmuka"><h1 class="svelte-1ggmuka">Friends</h1> <div class="friend-actions svelte-1ggmuka"><button class="btn btn-primary svelte-1ggmuka">Add Friend</button></div></header> <div class="friends-list svelte-1ggmuka"><!></div></div> <!>',1);function be(I,h){X(h,!0);const x=()=>re(H,"$friends",N),[N,R]=se();let g=L(""),c=L(!1);async function k(){try{const a=(await w("get_friends")).map(d=>({publicKey:d,addedAt:Date.now()}));H.set(a)}catch(e){console.error("Failed to load friends:",e)}}async function S(){if(l(g).trim())try{const e=await w("add_friend",{friendCode:l(g)});console.log("added friend: ",e),v(c,!1),v(g,""),await k(),p("Friend added successfully!")}catch(e){console.error("Failed to add friend:",e),p("Failed to add friend",!0)}}async function T(e){try{await w("remove_friend",{publicKey:e}),await k(),p("Friend removed successfully!")}catch(a){console.error("Failed to remove friend:",a),p("Failed to remove friend",!0)}}Y(async()=>{await k()});var A=ve(),y=E(A),F=s(y),K=n(s(F),2),$=s(K);r(K),r(F);var C=n(F,2),j=s(C);{var q=e=>{var a=ne();b(e,a)},G=e=>{var a=ee(),d=E(a);de(d,1,x,o=>o.publicKey,(o,u)=>{var f=oe(),m=s(f),t=s(m),Q=s(t,!0);r(t);var D=n(t,2),U=s(D);r(D),r(m);var V=n(m,2);r(f),te(W=>{M(Q,l(u).publicKey),M(U,`Added ${W??""}`)},[()=>new Date(l(u).addedAt).toLocaleDateString()]),i("click",V,()=>T(l(u).publicKey)),b(o,f)}),b(e,a)};P(j,e=>{x().length===0?e(q):e(G,!1)})}r(C),r(y);var J=n(y,2);{var O=e=>{var a=le(),d=s(a),o=n(s(d),4);ae(o);var u=n(o,2),f=s(u),m=n(f,2);r(u),r(d),r(a),ie(o,()=>l(g),t=>v(g,t)),i("click",f,()=>v(c,!1)),i("click",m,S),i("click",d,z(function(t){B.call(this,h,t)})),i("keydown",d,z(function(t){B.call(this,h,t)})),i("click",a,()=>v(c,!1)),i("keydown",a,t=>t.key==="Escape"&&v(c,!1)),b(e,a)};P(J,e=>{l(c)&&e(O)})}i("click",$,()=>v(c,!0)),b(I,A),Z(),R()}export{be as component};
